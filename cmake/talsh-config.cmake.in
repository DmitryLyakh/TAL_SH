cmake_minimum_required(VERSION 3.17.0 FATAL_ERROR)

@PACKAGE_INIT@

set(USE_HIP @USE_HIP@)
set(TALSH_GPU @TALSH_GPU@)
set(USE_OPENMP @USE_OPENMP@) 
set(WITH_CUTENSOR @WITH_CUTENSOR@)
set(TALSH_FINE_TIMING @TALSH_FINE_TIMING@)

# include( CMakeFindDependencyMacro )
if(USE_OPENMP)
    find_package(OpenMP REQUIRED)
endif()

if(TALSH_GPU)
    find_package(CUDAToolkit REQUIRED COMPONENTS cublas)
endif() 

if(NOT TARGET talsh::talsh)
    include("${CMAKE_CURRENT_LIST_DIR}/talsh-targets.cmake")
endif()

set(TALSH_FOUND TRUE)
set(TALSH_LIBRARIES talsh::talsh)
set(TALSH_INCLUDE_DIRS "@PACKAGE_CMAKE_INSTALL_INCLUDEDIR@")

if(TALSH_FINE_TIMING)
    list(APPEND TALSH_COMPILE_DEFINITIONS GPU_FINE_TIMING)
endif()

if(TALSH_GPU)
    set(TALSH_COMPILE_DEFINITIONS USE_TALSH)
    list(APPEND TALSH_INCLUDE_DIRS ${CUDAToolkit_INCLUDE_DIRS})
endif()

if(TALSH_GPU AND WITH_CUTENSOR)
    set(CUTENSOR_ROOT @CUTENSOR_ROOT@)
    list(APPEND TALSH_COMPILE_DEFINITIONS USE_CUTENSOR)
    list(APPEND TALSH_INCLUDE_DIRS ${CUTENSOR_ROOT}/include)
endif()

if(USE_HIP)
    set(TALSH_COMPILE_DEFINITIONS USE_HIP)
    set(HIP_LIBRARIES @HIP_LIBRARIES@)
    set(HIP_INCLUDE_DIRS @HIP_INCLUDE_DIRS@)
    set(HIPBLAS_INCLUDE_DIRS @HIPBLAS_INCLUDE_DIRS@)
    list(APPEND TALSH_INCLUDE_DIRS ${HIP_INCLUDE_DIRS} ${HIPBLAS_INCLUDE_DIRS})
    list(APPEND TALSH_LIBRARIES ${HIP_LIBRARIES})
endif()